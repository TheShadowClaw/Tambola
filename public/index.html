<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tambola Office Edition - Remote Team Gaming</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 50px;
            padding: 50px 20px;
        }

        .header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 1.3em;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .header .description {
            font-size: 1.1em;
            max-width: 600px;
            margin: 0 auto 40px;
            opacity: 0.8;
            line-height: 1.6;
        }

        .role-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 50px;
        }

        .role-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .role-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }

        .role-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .role-icon {
            font-size: 4em;
            margin-bottom: 20px;
            display: block;
        }

        .role-card h2 {
            color: #333;
            font-size: 2em;
            margin-bottom: 15px;
        }

        .role-description {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
            font-size: 1.1em;
        }

        .role-features {
            list-style: none;
            margin-bottom: 30px;
            text-align: left;
        }

        .role-features li {
            padding: 8px 0;
            color: #555;
            position: relative;
            padding-left: 25px;
        }

        .role-features li:before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            background: linear-gradient(45deg, #764ba2, #667eea);
        }

        .features-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .feature-card {
            text-align: center;
            padding: 20px;
        }

        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            display: block;
        }

        .feature-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .feature-card p {
            color: #666;
            line-height: 1.5;
        }

        .game-interface {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .back-btn {
            background: #6c757d;
            margin-bottom: 20px;
        }

        .join-form {
            text-align: center;
            max-width: 400px;
            margin: 0 auto;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
            text-align: left;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .host-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #667eea;
        }

        .stat-card h4 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }

        @media (max-width: 768px) {
            .role-selection {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .header h1 {
                font-size: 2.5em;
            }
            
            .role-card {
                padding: 30px 20px;
            }
            
            .features-section {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Tambola Office Edition</h1>
            <div class="subtitle">Remote Team Gaming Platform</div>
            <div class="description">
                Bring your team together with the classic game of Tambola (Housie)! 
                Perfect for office parties, team building, and remote celebrations. 
                Up to 50 players can join from anywhere in the world.
            </div>
        </div>

        <!-- Role Selection Screen -->
        <div id="roleSelection">
            <div class="role-selection">
                <div class="role-card" onclick="showHostInterface()">
                    <span class="role-icon">üéÆ</span>
                    <h2>Game Host</h2>
                    <div class="role-description">
                        Take control as the game master. Call numbers, manage the game, 
                        and celebrate with your team when they win!
                    </div>
                    <ul class="role-features">
                        <li>Start and manage games</li>
                        <li>Call numbers with one click</li>
                        <li>Track all winners in real-time</li>
                        <li>Monitor player connections</li>
                        <li>Reset games as needed</li>
                    </ul>
                    <div class="btn">Host a Game</div>
                </div>

                <div class="role-card" onclick="showPlayerInterface()">
                    <span class="role-icon">üéØ</span>
                    <h2>Player</h2>
                    <div class="role-description">
                        Join the fun! Get your tambola ticket and play along. 
                        Works perfectly on mobile devices and computers.
                    </div>
                    <ul class="role-features">
                        <li>Auto-generated tambola tickets</li>
                        <li>Easy number marking system</li>
                        <li>Claim wins instantly</li>
                        <li>Real-time game updates</li>
                        <li>Mobile-friendly interface</li>
                    </ul>
                    <div class="btn">Join as Player</div>
                </div>
            </div>

            <div class="features-section">
                <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Game Features</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">üè†</span>
                        <h3>All Classic Patterns</h3>
                        <p>Early Five, Lines, Four Corners, and Full House - all the traditional Tambola winning patterns</p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">‚ö°</span>
                        <h3>Real-time Gameplay</h3>
                        <p>Instant number calling, automatic ticket marking, and live winner announcements</p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">üì±</span>
                        <h3>Multi-device Support</h3>
                        <p>Play on phones, tablets, or computers - responsive design works everywhere</p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">üë•</span>
                        <h3>Team Building</h3>
                        <p>Perfect for office parties, virtual team events, and remote team bonding</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Host Interface -->
        <div id="hostInterface" class="game-interface">
            <button class="btn back-btn" onclick="showRoleSelection()">‚Üê Back to Home</button>
            <h2 style="text-align: center; margin-bottom: 30px;">üéÆ Host Control Panel</h2>
            
            <div class="host-controls">
                <button id="startButton" class="btn" onclick="startGame()">Start Game</button>
                <button id="callButton" class="btn" onclick="callNumber()" disabled>Call Number</button>
                <button id="resetButton" class="btn" onclick="resetGame()">Reset Game</button>
            </div>

            <div id="currentNumber" style="text-align: center; font-size: 3em; color: #667eea; margin: 20px 0;">
                Ready to Start
            </div>

            <div class="game-stats">
                <div class="stat-card">
                    <h4>Connected Players</h4>
                    <div id="playerCount" class="stat-value">0</div>
                </div>
                <div class="stat-card">
                    <h4>Numbers Called</h4>
                    <div id="numbersCalledCount" class="stat-value">0</div>
                </div>
                <div class="stat-card">
                    <h4>Numbers Remaining</h4>
                    <div id="numbersRemaining" class="stat-value">90</div>
                </div>
                <div class="stat-card">
                    <h4>Game Status</h4>
                    <div id="gameStatus" class="stat-value">Waiting</div>
                </div>
            </div>

            <div id="winners" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h3>üèÜ Winners</h3>
                <div id="winnersList">No winners yet</div>
            </div>
        </div>

        <!-- Player Interface -->
        <div id="playerInterface" class="game-interface">
            <button class="btn back-btn" onclick="showRoleSelection()">‚Üê Back to Home</button>
            <h2 style="text-align: center; margin-bottom: 30px;">üéØ Join the Game</h2>
            
            <div class="join-form">
                <div class="input-group">
                    <label for="playerName">Your Name:</label>
                    <input type="text" id="playerName" placeholder="Enter your name" maxlength="20" required>
                </div>
                <button class="btn" onclick="joinGame()">Join Game</button>
            </div>

            <div id="gameArea" style="display: none; margin-top: 30px;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <h3>Game Status: <span id="playerGameStatus">Joined</span></h3>
                    <div id="playerCurrentNumber" style="font-size: 2em; color: #667eea; margin: 10px 0;">
                        Waiting for game to start...
                    </div>
                </div>

                <div id="ticket" style="background: white; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <!-- Ticket will be generated here -->
                </div>

                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" onclick="claimWin('earlyFive')">Early Five</button>
                    <button class="btn" onclick="claimWin('topLine')">Top Line</button>
                    <button class="btn" onclick="claimWin('middleLine')">Middle Line</button>
                    <button class="btn" onclick="claimWin('bottomLine')">Bottom Line</button>
                    <button class="btn" onclick="claimWin('corners')">Four Corners</button>
                    <button class="btn" onclick="claimWin('fullHouse')">Full House</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const socket = io();
        let currentRole = null;
        let gameActive = false;
        let currentTicket = [];
        let markedNumbers = [];

        // Navigation functions
        function showRoleSelection() {
            document.getElementById('roleSelection').style.display = 'block';
            document.getElementById('hostInterface').style.display = 'none';
            document.getElementById('playerInterface').style.display = 'none';
            currentRole = null;
        }

        function showHostInterface() {
            document.getElementById('roleSelection').style.display = 'none';
            document.getElementById('hostInterface').style.display = 'block';
            document.getElementById('playerInterface').style.display = 'none';
            currentRole = 'host';
        }

        function showPlayerInterface() {
            document.getElementById('roleSelection').style.display = 'none';
            document.getElementById('hostInterface').style.display = 'none';
            document.getElementById('playerInterface').style.display = 'block';
            currentRole = 'player';
        }

        // Host functions
        function startGame() {
            socket.emit('startGame');
        }

        function callNumber() {
            socket.emit('callNumber');
        }

        function resetGame() {
            socket.emit('resetGame');
        }

        // Player functions
        function joinGame() {
            const name = document.getElementById('playerName').value.trim();
            if (!name) {
                alert('Please enter your name');
                return;
            }
            socket.emit('joinGame', name);
        }

        function claimWin(pattern) {
            socket.emit('claimWin', pattern);
        }

        // Socket event handlers
        socket.on('playerCount', (count) => {
            document.getElementById('playerCount').textContent = count;
        });

        socket.on('gameStarted', () => {
            gameActive = true;
            if (currentRole === 'host') {
                document.getElementById('gameStatus').textContent = 'Active';
                document.getElementById('startButton').disabled = true;
                document.getElementById('callButton').disabled = false;
            } else if (currentRole === 'player') {
                document.getElementById('playerGameStatus').textContent = 'Game Active';
            }
        });

        socket.on('numberCalled', (data) => {
            const { number, calledNumbers } = data;
            if (currentRole === 'host') {
                document.getElementById('currentNumber').textContent = number;
                document.getElementById('numbersCalledCount').textContent = calledNumbers.length;
                document.getElementById('numbersRemaining').textContent = 90 - calledNumbers.length;
            } else if (currentRole === 'player') {
                document.getElementById('playerCurrentNumber').textContent = number;
            }
        });

        socket.on('ticketGenerated', (ticket) => {
            currentTicket = ticket;
            displayTicket(ticket);
            document.getElementById('gameArea').style.display = 'block';
        });

        socket.on('winnerAnnounced', (data) => {
            const { pattern, winner } = data;
            if (currentRole === 'host') {
                const winnersList = document.getElementById('winnersList');
                winnersList.innerHTML += `<div style="margin: 5px 0; padding: 10px; background: #28a745; color: white; border-radius: 5px;">üéâ ${winner} won ${pattern}!</div>`;
            }
        });

        function displayTicket(ticket) {
            const ticketElement = document.getElementById('ticket');
            let html = '<table style="width: 100%; border-collapse: collapse;">';
            
            for (let row = 0; row < 3; row++) {
                html += '<tr>';
                for (let col = 0; col < 9; col++) {
                    const number = ticket[row][col];
                    const cellId = `cell-${row}-${col}`;
                    
                    if (number === 0) {
                        html += '<td style="width: 50px; height: 50px; border: 2px solid #ddd; background: #6c757d;"></td>';
                    } else {
                        html += `<td style="width: 50px; height: 50px; border: 2px solid #ddd; text-align: center; font-weight: bold; cursor: pointer; background: #f8f9fa;" id="${cellId}" onclick="markNumber(${number})">${number}</td>`;
                    }
                }
                html += '</tr>';
            }
            html += '</table>';
            ticketElement.innerHTML = html;
        }

        function markNumber(number) {
            // Add marking logic here
            const cells = document.querySelectorAll(`td[onclick*="${number}"]`);
            cells.forEach(cell => {
                cell.style.background = '#28a745';
                cell.style.color = 'white';
            });
            socket.emit('markNumber', number);
        }

        // Initialize
        showRoleSelection();
    </script>
</body>
</html>
